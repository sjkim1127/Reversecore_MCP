"""Malware analysis tools package.

Provides a unified MalwareToolsPlugin that registers all malware-related tools.
"""

from typing import Any

from reversecore_mcp.core.logging_config import get_logger
from reversecore_mcp.core.plugin import Plugin

logger = get_logger(__name__)


class MalwareToolsPlugin(Plugin):
    """Unified plugin for all malware analysis tools."""

    @property
    def name(self) -> str:
        return "malware_tools"

    @property
    def description(self) -> str:
        return "Unified malware analysis tools including detection, vaccine generation, IOC extraction, and YARA scanning."

    def register(self, mcp_server: Any) -> None:
        """Register all malware tools."""
        # Import tool functions from submodules
        from reversecore_mcp.tools.malware.dormant_detector import dormant_detector
        from reversecore_mcp.tools.malware.adaptive_vaccine import adaptive_vaccine
        from reversecore_mcp.tools.malware.vulnerability_hunter import vulnerability_hunter
        from reversecore_mcp.tools.malware.ioc_tools import extract_iocs
        from reversecore_mcp.tools.malware.yara_tools import run_yara

        # Register all tools
        mcp_server.tool(dormant_detector)
        mcp_server.tool(adaptive_vaccine)
        mcp_server.tool(vulnerability_hunter)
        mcp_server.tool(extract_iocs)
        mcp_server.tool(run_yara)

        logger.info(f"Registered {self.name} plugin with 5 malware tools (unified)")


__all__ = ["MalwareToolsPlugin"]
